###############################################################################
# Example multi-project Laravel vhosts
# - Put each Laravel project under /src in your host:
#     /src/project1
#     /src/project2
# - Each project must have a public/ directory (standard Laravel).
# - Apache serves HTTP, PHP is executed by the php-fpm "app" container.
###############################################################################

<VirtualHost *:80>
    ServerName project01.local

    DocumentRoot /var/www/project01/public
    DirectoryIndex index.php

    <Directory /var/www/project01/public>
        Options FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    RewriteEngine On

    <FilesMatch \.php$>
        SetHandler "proxy:fcgi://app:9000"
    </FilesMatch>

    ErrorLog /var/log/httpd/project01-error.log
    CustomLog /var/log/httpd/project01-access.log combined

    RewriteCond %{REQUEST_URI} ^/(js|css|lib|img|fonts)/(.*)$
    RewriteRule ^/(js|css|lib|img|fonts)/(.*)$ /project01/$1/$2 [NC,L]
    RewriteCond %{REQUEST_URI} ^/favicon\.ico$
    RewriteRule ^/favicon\.ico$ /project01/favicon\.ico [NC,L]

    RewriteCond %{DOCUMENT_ROOT}%{REQUEST_URI} !-d
    RewriteCond %{DOCUMENT_ROOT}%{REQUEST_URI} !-f
    RewriteRule ^ /index.php [L]
</VirtualHost>

<VirtualHost *:80>
    ServerName project02.local

    DocumentRoot /var/www/project02/public
    DirectoryIndex index.php

    <Directory /var/www/project02/public>
        Options FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    RewriteEngine On

    <FilesMatch \.php$>
        SetHandler "proxy:fcgi://app:9000"
    </FilesMatch>

    ErrorLog /var/log/httpd/project2-error.log
    CustomLog /var/log/httpd/project2-access.log combined

    RewriteCond %{REQUEST_URI} ^/(js|css|lib|img|fonts)/(.*)$
    RewriteRule ^/(js|css|lib|img|fonts)/(.*)$ /project02/$1/$2 [NC,L]
    RewriteCond %{REQUEST_URI} ^/favicon\.ico$
    RewriteRule ^/favicon\.ico$ /project02/favicon\.ico [NC,L]

    RewriteCond %{DOCUMENT_ROOT}%{REQUEST_URI} !-d
    RewriteCond %{DOCUMENT_ROOT}%{REQUEST_URI} !-f
    RewriteRule ^ /index.php [L]
</VirtualHost>

# Add more projects by copying one of the VirtualHost blocks above
# and adjusting ServerName + paths, e.g. project3.local â†’ /var/www/project3/public


